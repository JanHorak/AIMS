<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:dialog="http://xmlns.jcp.org/jsf/composite/comp/dialogs"
      xmlns:includes="http://xmlns.jcp.org/jsf/composite/includes">
    <h:body>

        <ui:composition template="/content/aims/index.xhtml">
            <ui:define name="content">
                <h:form id="managementform">
                    <h1>USERMANAGEMENT</h1>
                    Here you can confirm incoming applications and manage the current members.
                    <p:accordionPanel>
                        <p:tab title="#{msg.regMembers} , (#{management.countOfNonApplicants})">
                            <p:dataTable value="#{management.nonApplicantMembers}" var="member">
                                <p:column headerText="Avatar">
                                    <p:row>
                                        <p:graphicImage id="id" value="#{imageHelper.getImageById(member)}" style="height: 128px; width: 128px;" alt="Error">
                                            <f:param id="memberid" name="member_id" value="#{member.id}" />
                                        </p:graphicImage>
                                    </p:row>
                                </p:column>
                                <p:column headerText="#{msg.name}">
                                    <p:row>
                                        #{member.lastname} , #{member.forename}
                                    </p:row>
                                </p:column>
                                <p:column headerText="#{msg.currentRank}">
                                    <p:row>
                                        #{member.rank}
                                    </p:row>
                                </p:column>
                                <p:column headerText="#{msg.admin}">
                                    <p:row>
                                        #{member.hasAdminrights() ? 'Yes' : 'No'}
                                    </p:row>
                                </p:column>
                                <p:column headerText="#{msg.options}">
                                    <p:row>
                                        <p:link value="Edit" />
                                    </p:row>
                                </p:column>
                            </p:dataTable>
                        </p:tab>
                        <p:tab title="#{msg.newMembers}, (#{management.countOfApplicants})">
                            <p:dataTable id="appTable" value="#{management.applicantMembers}" var="appMember" selection="#{management.selectedMember}" rowKey="#{appMember.id}">
                                <p:column headerText="#{msg.name}">
                                    <p:row>
                                        #{appMember.lastname} , #{appMember.forename}
                                    </p:row>
                                </p:column>
                                <p:column headerText="#{msg.emailaddress_header}">
                                    <p:row>
                                        #{appMember.email}
                                    </p:row>
                                </p:column>
                                <p:column headerText="#{msg.options}">
                                    <p:row>
                                        <p:commandButton value="#{msg.confirm}" update=":confirmDialog" oncomplete="PF('d1').show();">
                                            <f:setPropertyActionListener value="#{appMember}" target="#{management.selectedMember}"/>
                                        </p:commandButton>
                                        <p:commandButton value="#{msg.reject}" />
                                    </p:row>
                                </p:column>
                            </p:dataTable>
                        </p:tab>
                    </p:accordionPanel>
                </h:form>

                <p:dialog
                    id="confirmDialog"
                    widgetVar="d1" 
                    header="asd" 
                    width="600"
                    height="500"
                    modal="true" 
                    resizable="false" 
                    closable="true" 
                    draggable="false"
                    dynamic="true">
                    <h:form>
                        <p:outputLabel value="User wants to be added to the system" />
                        <includes:memberData member="#{management.selectedMember}" allFieldsReadOnly="true"/>
                        <f:facet name="footer">
                            <h:panelGroup layout="block" styleClass="dialogFooter">

                            </h:panelGroup>
                        </f:facet>
                    </h:form>
                </p:dialog>

            </ui:define>
        </ui:composition>
    </h:body>


</html>